{"ast":null,"code":"var _jsxFileName = \"C:\\\\Programming\\\\Codeit Sprint\\\\part-2\\\\react-practice\\\\moviepedia\\\\src\\\\components\\\\App.js\",\n  _s = $RefreshSig$();\nimport ReviewList from \"./ReviewList\";\nimport { useCallback, useEffect, useState } from \"react\";\nimport { createReview, deleteReview, getReviews, updateReview } from \"./api\";\nimport ReviewForm from \"./ReviewForm\";\nimport useAsync from \"./hooks/useAsync\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst LIMIT = 6;\nfunction App() {\n  _s();\n  // 최상위 컴포넌트\n  const [items, setItems] = useState([]);\n  const [order, setOrder] = useState(\"createdAt\");\n  const [offset, setOffset] = useState(0);\n  const [hasNext, setHasNext] = useState(false);\n  const [isLoading, loadingError, getReviewsAsync] = useAsync(getReviews);\n  const handleNewstClick = () => setOrder(\"createdAt\");\n  const handleBestClick = () => setOrder(\"rating\");\n  const sortedItems = items.sort((a, b) => b[order] - a[order]);\n  const handleDelete = async id => {\n    const reslut = await deleteReview(id);\n    if (!reslut) return;\n\n    //prevItems : setter 함수에서 콜백으로 받는 매개변수\n    // state 변경 전의 값을 참조하고 있음 , 즉 삭제하기 전에 item들\n    setItems(prevItems => prevItems.filter(item => item.id !== id));\n  };\n  const handleLoad = useCallback(async options => {\n    const result = await getReviewsAsync(options);\n    if (!result) return;\n    const {\n      reviews,\n      paging\n    } = result;\n    if (options.offset === 0) {\n      setItems(reviews);\n    } else {\n      // previtems : 현재 state 값\n      setItems(previtems => [...previtems, ...reviews]);\n    }\n    // 데이터를 받아온 후 작업 offset limit값만큼 증가\n    setOffset(options.offset + reviews.length);\n    setHasNext(paging.hasNext); // 리스폰스에 있는 paging 객체\n  }, []);\n  const handleLoadMore = () => {\n    // 다음 페이지를 불러오는 함수\n    handleLoad({\n      order,\n      offset,\n      limit: LIMIT\n    });\n  };\n  const handleCreateSuccess = review => {\n    setItems(prevItems => [review, ...prevItems]);\n  };\n  const handleUpdateSuccess = review => {\n    setItems(prevItems => {\n      const splitIdx = prevItems.findIndex(item => item.id === review.id);\n      // 수정할 인덱스 찾기\n      // 기존 리뷰 배열에서 같은 아이디에 해당하는 리뷰 갈아끼움 ..\n      return [...prevItems.slice(0, splitIdx), review, ...prevItems.slice(splitIdx + 1)];\n    });\n  };\n  useEffect(() => {\n    handleLoad({\n      order,\n      offset: 0,\n      limit: LIMIT\n    });\n  }, [order, handleLoad]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleNewstClick,\n        children: \"\\uCD5C\\uC2E0\\uC21C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleBestClick,\n        children: \"\\uBCA0\\uC2A4\\uD2B8\\uC21C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ReviewForm, {\n      onSubmitSuccess: handleCreateSuccess,\n      onSubmit: createReview\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ReviewList, {\n      items: sortedItems,\n      onDelete: handleDelete,\n      onUpdate: updateReview,\n      onUpdateSuccess: handleUpdateSuccess\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this), hasNext && /*#__PURE__*/_jsxDEV(\"button\", {\n      disabled: isLoading,\n      onClick: handleLoadMore,\n      children: \"\\uB354\\uBCF4\\uAE30\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 9\n    }, this), (loadingError === null || loadingError === void 0 ? void 0 : loadingError.message) && /*#__PURE__*/_jsxDEV(\"span\", {\n      children: loadingError.message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 33\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"i51Z0OKuzAbpDp/PoNooqEBmoTM=\", false, function () {\n  return [useAsync];\n});\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["ReviewList","useCallback","useEffect","useState","createReview","deleteReview","getReviews","updateReview","ReviewForm","useAsync","jsxDEV","_jsxDEV","LIMIT","App","_s","items","setItems","order","setOrder","offset","setOffset","hasNext","setHasNext","isLoading","loadingError","getReviewsAsync","handleNewstClick","handleBestClick","sortedItems","sort","a","b","handleDelete","id","reslut","prevItems","filter","item","handleLoad","options","result","reviews","paging","previtems","length","handleLoadMore","limit","handleCreateSuccess","review","handleUpdateSuccess","splitIdx","findIndex","slice","children","onClick","fileName","_jsxFileName","lineNumber","columnNumber","onSubmitSuccess","onSubmit","onDelete","onUpdate","onUpdateSuccess","disabled","message","_c","$RefreshReg$"],"sources":["C:/Programming/Codeit Sprint/part-2/react-practice/moviepedia/src/components/App.js"],"sourcesContent":["import ReviewList from \"./ReviewList\";\r\nimport { useCallback, useEffect, useState } from \"react\";\r\nimport { createReview, deleteReview, getReviews, updateReview } from \"./api\";\r\nimport ReviewForm from \"./ReviewForm\";\r\nimport useAsync from \"./hooks/useAsync\";\r\n\r\nconst LIMIT = 6;\r\n\r\nfunction App() {\r\n  // 최상위 컴포넌트\r\n  const [items, setItems] = useState([]);\r\n  const [order, setOrder] = useState(\"createdAt\");\r\n  const [offset, setOffset] = useState(0);\r\n  const [hasNext, setHasNext] = useState(false);\r\n  const [isLoading, loadingError, getReviewsAsync] = useAsync(getReviews);\r\n\r\n  const handleNewstClick = () => setOrder(\"createdAt\");\r\n  const handleBestClick = () => setOrder(\"rating\");\r\n\r\n  const sortedItems = items.sort((a, b) => b[order] - a[order]);\r\n\r\n  const handleDelete = async (id) => {\r\n    const reslut = await deleteReview(id);\r\n    if (!reslut) return;\r\n\r\n    //prevItems : setter 함수에서 콜백으로 받는 매개변수\r\n    // state 변경 전의 값을 참조하고 있음 , 즉 삭제하기 전에 item들\r\n    setItems((prevItems) => prevItems.filter((item) => item.id !== id));\r\n  };\r\n\r\n  const handleLoad = useCallback(async (options) => {\r\n    const result = await getReviewsAsync(options);\r\n    if (!result) return;\r\n\r\n    const { reviews, paging } = result;\r\n    if (options.offset === 0) {\r\n      setItems(reviews);\r\n    } else {\r\n      // previtems : 현재 state 값\r\n      setItems((previtems) => [...previtems, ...reviews]);\r\n    }\r\n    // 데이터를 받아온 후 작업 offset limit값만큼 증가\r\n    setOffset(options.offset + reviews.length);\r\n    setHasNext(paging.hasNext); // 리스폰스에 있는 paging 객체\r\n  }, []);\r\n\r\n  const handleLoadMore = () => {\r\n    // 다음 페이지를 불러오는 함수\r\n    handleLoad({ order, offset, limit: LIMIT });\r\n  };\r\n\r\n  const handleCreateSuccess = (review) => {\r\n    setItems((prevItems) => [review, ...prevItems]);\r\n  };\r\n\r\n  const handleUpdateSuccess = (review) => {\r\n    setItems((prevItems) => {\r\n      const splitIdx = prevItems.findIndex((item) => item.id === review.id);\r\n      // 수정할 인덱스 찾기\r\n      // 기존 리뷰 배열에서 같은 아이디에 해당하는 리뷰 갈아끼움 ..\r\n      return [\r\n        ...prevItems.slice(0, splitIdx),\r\n        review,\r\n        ...prevItems.slice(splitIdx + 1),\r\n      ];\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    handleLoad({ order, offset: 0, limit: LIMIT });\r\n  }, [order, handleLoad]);\r\n\r\n  return (\r\n    <div>\r\n      <div>\r\n        <button onClick={handleNewstClick}>최신순</button>\r\n        <button onClick={handleBestClick}>베스트순</button>\r\n      </div>\r\n      <ReviewForm\r\n        onSubmitSuccess={handleCreateSuccess}\r\n        onSubmit={createReview}\r\n      />\r\n      <ReviewList\r\n        items={sortedItems}\r\n        onDelete={handleDelete}\r\n        onUpdate={updateReview}\r\n        onUpdateSuccess={handleUpdateSuccess}\r\n      />\r\n\r\n      {/* hasNext 값이 true인 경우 실행, false인 경우 표현식 계산하지 않고 hasNext의 값을 사용함 (리액트에서 false 값은 렌더링하지 않음)  \r\n      로딩되고 있는 경우에는 버튼을 비활성화 처리 \r\n      비활성화 처리하지 않는 경우 로딩 중에 버튼을 클릭할 수 있어 불필요한 리퀘스트 발생 가능함 */}\r\n      {hasNext && (\r\n        <button disabled={isLoading} onClick={handleLoadMore}>\r\n          더보기\r\n        </button>\r\n      )}\r\n      {loadingError?.message && <span>{loadingError.message}</span>}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}